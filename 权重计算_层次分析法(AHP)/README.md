# 层次分析法 (AHP) MATLAB 函数库

本文件夹包含用于执行层次分析法 (AHP) 的 MATLAB 函数。AHP 是一种用于复杂决策的多标准分析方法。

## 文件

- `AHP_EigenvectorMethod.m`: 使用 **特征向量法** 计算权重。这是 AHP 最常用且最精确的方法。
- `AHP_RootMethod.m`: 使用 **方根法（几何平均法）** 计算权重。这是一种较为简单的近似方法。
- `main_AHP_analysis.m`: 一个示例脚本，演示如何调用上述两个函数并解释结果。

## 如何使用

1.  在 MATLAB 中打开 `main_AHP_analysis.m` 文件。
2.  根据您的决策问题，修改脚本中的 **判断矩阵 `A`**。
3.  运行脚本。

脚本将输出两种方法计算的权重向量和一致性比例。

### 函数说明

#### `[w, CR, lambda_max] = AHP_EigenvectorMethod(A)`

-   **输入**:
    -   `A`: 一个 n x n 的成对比较矩阵。
-   **输出**:
    -   `w`: 权重向量。
    -   `CR`: 一致性比例。如果 `CR >= 0.1`，则表示判断矩阵的一致性可能存在问题，需要重新评估。
    -   `lambda_max`: 矩阵的最大特征值。

#### `[w, CR] = AHP_RootMethod(A)`

-   **输入**:
    -   `A`: 一个 n x n 的成对比较矩阵。
-   **输出**:
    -   `w`: 权重向量。
    -   `CR`: 一致性比例。

## 示例

请参考 `main_AHP_analysis.m` 中的示例代码。

---

## 附录：关于 RI (平均随机一致性指标)

您可能会好奇代码中的 `RI_values` 是从何而来的。

`RI` 值并不是实时计算的，而是通过大规模蒙特卡洛模拟得出的经验数据。其计算过程如下：

1.  **生成随机矩阵**：对于给定的阶数 `n`，通过计算机生成大量（例如 500 个或更多）的随机成对比较矩阵。矩阵中的元素从 {1, 2, ..., 9} 及其倒数中随机抽取。
2.  **计算一致性指标 (CI)**：为每一个随机矩阵计算其最大特征值 `λ_max`，并得到其一致性指标 `CI = (λ_max - n) / (n - 1)`。
3.  **求平均**：将所有随机矩阵的 `CI` 值求算术平均，这个平均值就是该阶数 `n` 的 `RI` 值。

这个过程由 AHP 的创始人完成，并将结果制成标准表格，为我们判断矩阵的一致性提供了一个可靠的基准。
