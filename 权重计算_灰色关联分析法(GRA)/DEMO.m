% --- 灰色关联分析法 (GRA) 演示脚本 ---
clear; clc; close all;

% --- 1. 准备数据 ---
% 示例数据 (m x n, m=样本数, n=指标数)
% 假设我们有 20 个样本和 5 个指标
data=[0.4036 	10.41	3.79	18.2	636.64
    0.1662 	2.66	3.73	5.63	1015.05
    0.2845 	1.57	3.94	19.41	648.78
    0.3162 	6.92	4.18	20.38	649.06
    0.3231 	40.89	3.98	22.89	616.55
    0.3736 	11.7	3.85	12.19	592.17
    0.2876 	40.89	4	11.41	678.86
    0.2822 	4.73	4	18.9	841.95
    0.5865 	40.89	4	11.11	552.7
    0.4491 	5.52	4.97	17.01	1014.98
    0.5347 	40.89	4	15.65	467.31
    0.5477 	1.02	3.53	7.9	632
    0.4637 	40.89	4	12.45	609.88
    0.4867 	6.21	3.67	13.9	701.38
    0.4191 	2.19	3.17	15.88	838.85
    0.4928 	6	4	16.17	497.57
    0.5158 	4.71	3.83	16.4	648.46
    0.3852 	4.18	3.9	14.37	430.3
    0.3908 	40.89	4	11.88	531.15
    0.3524 	6.19	3.58	12.94	598.34 ];

% --- 2. 定义指标类型 ---
% 1 表示正向指标 (效益型, 数值越大越好)
% -1 表示负向指标 (成本型, 数值越小越好)
% 根据原始 huise.m 的注释，我们假设第3列是成本型指标
indicator_types = [1, 1, -1, 1, 1];

% --- 3. 调用函数计算权重 ---
% 可以选择传入第三个参数作为分辨系数 ro，若不传则默认为 0.5
[weights, gamma] = calculate_gra_weights(data, indicator_types);

% --- 4. 显示结果 ---
disp('--- 灰色关联分析 (GRA) 计算结果 ---');
disp(' ');
disp('各指标的灰色关联度 (gamma):');
disp(gamma);
disp(' ');
disp('各指标的权重 (weights):');
disp(weights);
disp(' ');
disp('权重之和:');
disp(sum(weights)); % 验证权重之和为 1

% --- 5. 结果可视化 ---
figure;
bar(weights);
title('灰色关联分析 (GRA) - 指标权重');
xlabel('指标序号');
ylabel('权重值');
grid on;
set(gca, 'XTickLabel', sprintfc('指标 %d', 1:length(weights)));
