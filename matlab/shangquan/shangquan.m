% ===== 1. 创建数据矩阵 (已修正) =====
% 格式：行=样本，列=指标
data = [
    47.73	0.8432	4.87	0.784	0.941	1.4158	2.2253 	0.0929 
54.39	1.2114	5.38	0.8795	0.9685	1.0978	2.2129 	0.0916 
60.16	1.4051	5.24	0.7255	0.9251	1.1437	2.2069 	0.0910 
61.49	0.8772	5.52	0.75	0.9196	0.9832	2.2311 	0.0936 
82.06	1.1708	6.75	0.7626	0.8285	0.4547	2.2257 	0.0930 
68.03	1.1863	5.74	0.6579	0.9492	0.8891	2.2153 	0.0919 
51.77	1.3911	5.14	0.6879	0.9528	1.2344	2.2471 	0.0958 
59.51	1.3214	5.54	0.83	0.9143	0.9676	2.2510 	0.0964 
62.23	1.2141	5.51	0.81	0.931	0.9948	2.2547 	0.0970 
50.35	0.8021	5.70	0.7243	0.9042	0.8373	2.2707 	0.1005 
55.18	0.7392	5.03	0.5881	0.8816	1.2413	2.2766 	0.1014 
56.52	1.1883	5.52	0.5223	0.8659	0.9411	2.2573 	0.0978 
72.24	0.8609	5.74	0.7988	0.8913	0.8551	2.2723 	0.1011 
66.02	1.2704	6.13	0.7131	0.849	0.667	2.2645 	0.1000 
54.06	1.1801	5.99	0.73	0.8629	0.7282	2.2651 	0.0999 
55.42	1.1174	5.73	0.65	0.8533	0.7286	2.2722 	0.1028 
80.13	0.6891	5.66	0.5178	0.9018	0.8972	2.2744 	0.1054 
87.61	1.087	6.81	0.565	0.8354	0.4423	2.2738 	0.1071 
81.05	0.8817	5.69	0.55	0.8818	0.8691	2.2766 	0.1073 
69.32	0.9017	6.05	0.6975	0.9053	0.7293	2.2643 	0.1065 
89.77	0.8195	5.53	0.4363	0.8659	0.9372	2.2712 	0.1060 
76.09	0.8763 	4.4887 	0.6554 	0.9776 	1.7408 	2.2460 	0.1039 
59.65	0.7917	6.18	0.7508	0.875	0.6608	2.2657 	0.1086 
74.00	0.6451	5.93	0.5876	0.8342	0.7382	2.2800 	0.1092 
65.17	0.8504	6.14	0.9000	0.8847	0.6804	2.2603 	0.1072 
66.95	0.7936	6.06	0.8996	0.8705	0.7033	2.2554 	0.1091 
60.50 	1.0477 	4.93 	0.5200 	0.9127 	0.7263 	1.9893 	0.0820 
62.05 	1.0192 	4.84 	0.5000 	0.9254 	0.7941 	1.9637 	0.0776 
65.02 	1.0095 	4.85 	0.4150 	0.9234 	0.7869 	1.9640 	0.0753 
60.19 	1.0198 	4.93 	0.5320 	0.9131 	0.7259 	1.9848 	0.0747 
66.40 	1.1728 	4.84 	0.5950 	0.9130 	0.7676 	1.9818 	0.0719 
63.87 	0.9912 	4.91 	0.5250 	0.9080 	0.7245 	2.0006 	0.0699 
73.83 	0.8814 	4.00 	0.8640 	0.9018 	1.2733 	1.9749 	0.1031 
75.05 	0.8524 	4.15 	0.8430 	0.9113 	1.1905 	2.3376 	0.0816 
70.54 	0.8813 	4.30 	0.8430 	0.9033 	1.0572 	2.1024 	0.0973 
67.69 	0.9060 	4.48 	0.8100 	0.9028 	0.9407 	2.0475 	0.1015 
56.29 	0.8772 	5.78 	0.7510 	0.8926 	0.3707 	2.2941 	0.0954 
65.90 	0.9411 	4.66 	0.6570 	0.9100 	0.8549 	1.9704 	0.1050 
58.73 	0.9528 	5.13 	0.9750 	0.8945 	0.6035 	2.0864 	0.1046 
54.56 	0.9538 	5.37 	0.7960 	0.8799 	0.4865 	2.1624 	0.1069 
50.50 	0.9005 	5.22 	0.8057 	0.8522 	0.4977 	2.2761 	0.1156 
66.80 	1.0558 	4.82 	0.5710 	0.9168 	0.7866 	1.9670 	0.0739 
59.20 	1.0281 	4.79 	0.5154 	0.9224 	0.8177 	1.9762 	0.0766 
60.40 	1.0215 	4.82 	0.5100 	0.9252 	0.8075 	1.9791 	0.0751 
61.70 	1.0284 	4.90 	0.5300 	0.9195 	0.7556 	1.9828 	0.0763 
63.90 	1.1695 	4.88 	0.5170 	0.9185 	0.7626 	1.9422 	0.0848 
49.60 	1.0476 	5.20 	0.7000 	0.8917 	0.5690 	1.9533 	0.1057 
65.90 	0.9923 	4.79 	0.6650 	0.9120 	0.7928 	1.9183 	0.1044 
81.10 	0.9087 	4.83 	0.6500 	0.9158 	0.7802 	1.9005 	0.1024 
72.90 	0.8861 	4.02 	0.8470 	0.8997 	1.2500 	1.9585 	0.1049 
73.70 	0.9427 	5.67 	0.8510 	0.8048 	0.2451 	2.0216 	0.0674 
68.01 	1.0630 	5.35 	0.7520 	0.8579 	0.4520 	1.9975 	0.1132 
61.15 	0.8942 	5.36 	0.9060 	0.9137 	0.8139 	2.2048 	0.1180 
74.35 	0.9661 	5.78 	0.8471 	0.8677 	0.7064 	2.1748 	0.1096 
58.90 	1.1468 	6.93 	0.7330 	0.8736 	0.3347 	2.1443 	0.1009 
54.25 	1.3911 	5.63 	0.7953 	0.8872 	0.7952 	2.1521 	0.1041 
60.65 	0.8917 	7.06 	0.8829 	0.8500 	0.2857 	2.2038 	0.1135 
62.90 	0.8060 	5.96 	0.9149 	0.9001 	0.6667 	2.1715 	0.1061 
56.93 	0.8794 	6.26 	0.9098 	0.9179 	0.5720 	2.1522 	0.1010 
60.37 	0.8929 	6.37 	0.8400 	0.8885 	0.4793 	2.2196 	0.1153 
68.65 	0.8635 	5.78 	0.8694 	0.9527 	0.8096 	2.1726 	0.1032 
55.81 	1.1781 	6.46 	0.8462 	0.8629 	0.4583 	2.2250 	0.1075 
55.18 	1.2118 	6.22 	0.8464 	0.8500 	0.5239 	2.2112 	0.1060 
55.25 	1.1817 	4.77 	0.8479 	0.9226 	1.3847 	2.1974 	0.1042 
77.83 	0.9677 	5.84 	0.8700 	0.8673 	0.6517 	2.1813 	0.1016 
79.58 	0.8598 	7.43 	0.7889 	0.7724 	0.1599 	2.1618 	0.0980 
75.73 	0.8697 	6.84 	0.6980 	0.7943 	0.2780 	2.1473 	0.0952 
78.00 	0.8837 	6.28 	0.8500 	0.8772 	0.5179 	2.2292 	0.1045 
77.80 	1.0656 	5.61 	0.8540 	0.8444 	0.6748 	2.1759 	0.0975 
81.41 	1.1236 	6.71 	0.9300 	0.8844 	0.4013 	2.1207 	0.0935 
86.90 	0.7696 	5.80 	0.9150 	0.9075 	0.7415 	2.1864 	0.1117 
77.09 	0.9230 	6.46 	0.8520 	0.8845 	0.4563 	2.1311 	0.0945 
79.80 	0.8511 	6.02 	0.9490 	0.9158 	0.6197 	2.1581 	0.1013 
80.72 	0.9761 	5.70 	0.8090 	0.9040 	0.7681 	2.1870 	0.1042 ];

% ===== 2. 指定负向指标 =====
% 确定哪些指标是负向指标（值越小越好）
negative_cols = [2, 7, 8];

% ===== 3. 调用熵权法函数 =====
% 将下面的函数代码保存为 EWMshangquan.m 文件后，即可运行此行
[weights, normalized_data] = EWMshangquan(data, negative_cols);

% ===== 4. 查看结果 =====
disp('===== 各指标的最终权重 =====');
disp('指标1   指标2   指标3   指标4   指标5   指标6  指标7  指标8');
disp(weights);

disp(' ');
disp('===== 标准化后的数据矩阵 (Normalized Data) =====');
disp(normalized_data);
