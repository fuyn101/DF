% ===== 1. 创建数据矩阵 =====
% 在MATLAB命令窗口或脚本中创建数据矩阵
% 格式：行=样本，列=指标
data = [han 1.856630824	3	150.66	1	0.104908754	17.38
0.4919595	3	352.59	1	0.136678151	15.36
0.371517664	3.2	583.66	0.8167	0.222068313	13.72
0.466659415	2.5	91.93	1	0.686813187	12.46
0.709299746	2.5	585.93	0.9676	1.232	27.76
0.557840157	2.5	55.93	1	0.944643869	10.93
0.163608981	2.5	146.08	1	0.89406786	10.93
0.389909167	3.5	252.11	1	0.81191897	12.46
0.437602452	2.6	420.93	1	0.899745822	10.55
0.029706402	2.6	605.93	0.9653	0.884353741	23.44
0.475777784	3.7	680.78	0.9236	0.817026839	24.5
0.906730476	3.5	392.84	0.9796	0.89267117	23.44
0.572340076	4	304.05	0.9441	0.893415528	30.47
1.588460448	4	141.08	1	0.805412371	12.24];

% ===== 2. 指定负向指标 =====
% 确定哪些指标是负向指标（值越小越好）
% 例如：假设第3列和第6列是负向指标
negative_cols = [3, 6];

% ===== 3. 调用熵权法函数 =====
% 使用您定义的函数名 EWMshangquan
[weights, normalized_data] = EWMshangquan(data, negative_cols);

% ===== 4. 查看结果 =====
% 显示最终权重
disp(' ');
disp('===== 最终权重 =====');
disp(weights);

% 显示标准化数据
disp(' ');
disp('===== 标准化数据 =====');
disp(normalized_data);