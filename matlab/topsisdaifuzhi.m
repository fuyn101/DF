X = [95.64  0.000260845  3.35
     92.36  0.000219135  52
     97.96  0.000504949  8
     94.41  0.000403055  17
     100    0.001158199  3.5
     100    0.000195634  4.5
     100    0.000164752  4.5];

[n, m] = size(X);

% 步骤1：数据归一化（保持不变）
for j = 1:m
    X(:, j) = X(:, j) / sqrt(sum(X(:, j).^2));
end

w = [0.114186813  0.073360138  0.209605541];
W = X .* repmat(w, n, 1);

% 步骤2：定义指标类型 (关键修改)
% 创建指标类型向量：1=正向指标，0=负向指标
indicator_type = [1, 1, 0];  % 前两列正向，第三列负向

% 步骤3：确定理想解（根据指标类型分别处理）
Z = zeros(1, m);  % 正理想解
F = zeros(1, m);  % 负理想解

for j = 1:m
    if indicator_type(j) == 1  % 正向指标
        Z(j) = max(W(:, j));   % 取最大值
        F(j) = min(W(:, j));   % 取最小值
    else  % 负向指标
        Z(j) = min(W(:, j));   % 取最小值（因为越小越好）
        F(j) = max(W(:, j));   % 取最大值（因为越大越差）
    end
end

% 后续计算保持不变
D_pos = sqrt(sum((W - repmat(Z, n, 1)).^2, 2));
D_neg = sqrt(sum((W - repmat(F, n, 1)).^2, 2));

C = D_neg ./ (D_pos + D_neg);

[~, rank] = sort(C, 'descend');

k = 7;
disp(rank(1:k));