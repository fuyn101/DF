# 权重计算：序关系分析法 (G1) - MATLAB 实现

## 1. 概述

本项目提供了 **序关系分析法 (G1法)** 的 MATLAB 实现，这是一种用于确定主观权重的高效方法。与层次分析法 (AHP) 等需要构造复杂判断矩阵的方法不同，G1法仅需专家根据经验对指标的重要性进行排序，并给出相邻指标之间的相对重要性比值即可。这大大简化了赋权过程，使其更加直观和易于操作。

此实现将核心算法封装在 `G1.m` 函数中，并提供了一个清晰的示例脚本 `run_G1_example.m`，帮助用户快速理解和应用。

## 2. 文件结构

```
权重计算_主观_序关系分析法(G1)/
├── G1.m                 # 核心权重计算函数
├── run_G1_example.m     # 调用示例脚本
└── README.md            # 说明文档 (当前文件)
```

- **`G1.m`**: 一个封装好的 MATLAB 函数，它接收指标的重要性排序向量和相邻指标的重要性比值向量，然后计算并返回归一化后的权重。
- **`run_G1_example.m`**: 一个演示如何调用 `G1.m` 函数的示例脚本。用户可以参考此文件来设置自己的参数并进行计算。

## 3. G1 方法原理简介

G1法的核心步骤如下：

1.  **确定指标序关系**：
    由决策者或领域专家根据专业知识，对 `m` 个评价指标的重要性进行排序，形成一个序关系。例如，对于指标1、2、3，如果专家认为其重要性为：指标3 > 指标1 > 指标2，则该序关系被记录下来。

2.  **判断相邻指标的相对重要性**：
    决策者需要对**已排序**的相邻指标进行两两比较，给出其重要性比值 `r_k`。`r_k` 的定义为：
    `r_k = w_{k-1} / w_k`  (k = m, m-1, ..., 2)
    其中 `w_{k-1}` 和 `w_k` 分别是第 `k-1` 重要和第 `k` 重要指标的权重。`r_k` 的建议取值如下：
    - `1.0`: `x_{k-1}` 与 `x_k` 同等重要
    - `1.2`: `x_{k-1}` 比 `x_k` 稍微重要
    - `1.4`: `x_{k-1}` 比 `x_k` 明显重要
    - `1.6`: `x_{k-1}` 比 `x_k` 非常重要
    - `1.8`: `x_{k-1}` 比 `x_k` 极端重要

3.  **计算权重**：
    基于上述序关系和比值，可以推导出各指标的权重。本代码的计算逻辑如下：
    - 首先，将最不重要的指标（排序最后的指标）的权重 `w_m` 临时赋值为 1.0。
    - 然后，根据公式 `w_{k-1} = r_k * w_k`，从后向前递推出所有其他指标的未归一化权重。
    - 最后，将所有计算出的权重进行归一化处理（即每个权重除以总和），确保所有权重的总和为 1。

## 4. 使用方法

1.  **准备工作**：
    确保 `G1.m` 和 `run_G1_example.m` 文件位于 MATLAB 的当前工作目录或搜索路径中。

2.  **配置参数**：
    打开 `run_G1_example.m` 文件，根据您的实际需求修改以下参数：
    - `rankOrder` 向量：定义指标的重要性排序。这是一个包含指标编号的向量。例如，`[3, 1, 4, 2]` 表示指标3最重要，其次是指标1，然后是指标4，最后是指标2。
    - `r_values` 向量：定义**排序后**的相邻指标的重要性比值。其长度必须是指标数量减一。例如，如果排序是 `[3, 1, 4, 2]`，那么 `r_values` 应包含三个值，分别代表 `w_3/w_1`、`w_1/w_4` 和 `w_4/w_2` 的比值。

3.  **运行脚本**：
    - 在 MATLAB 编辑器中打开 `run_G1_example.m`，然后按 `F5` 键运行。
    - 或者，在 MATLAB 命令行窗口中，导航到该文件所在的目录，然后输入 `run_G1_example` 并按回车。

4.  **查看结果**：
    脚本运行后，计算出的最终权重向量将显示在 MATLAB 的命令行窗口中。示例脚本还会提供一个表格，清晰地展示每个指标对应的权重值。

## 5. 函数 `G1` 详解

```matlab
function w_subjective = G1(rankOrder, r_values)
```

-   **输入参数**:
    -   `rankOrder` (`1xm` 向量): 包含 `m` 个指标的重要性排序的向量，元素为指标的原始编号。
    -   `r_values` (`1x(m-1)` 向量): 包含 `m-1` 个相邻指标重要性比值的向量 `[r_2, r_3, ..., r_m]`。

-   **输出参数**:
    -   `w_subjective` (`1xm` 向量): 返回一个包含 `m` 个元素的主观权重向量，其顺序与指标的原始编号（1, 2, ..., m）对应，并且所有权重之和为 1。

---
*文档由 Cline (AI Software Engineer) 根据项目文件重构于 2025/07/19*
