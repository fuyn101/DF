% 清理工作环境
clear;
clc;

% ================= 调用示例 =================
% 本脚本用于演示如何调用 TOPSIS_standard 函数

% 示例数据
% 从 topsisdaifu.m 中获取的数据
% 现有9个评价对象，5个评价指标
X_test = [
    1	3.71	0.0004	10.1	10.7;
    0.964	25.87	0.0005	10.2	11.6;
    1	2.42	0.0004	10.2	11.2;
    0.97	3.67	0.0018	10.4	11.4;
    0.943	0.74	0.00032	10.2	11;
    1	0.73	0.00033	10.2	11.5;
    0.986	4.24	0.00035	10.7	11.6;
    1	1.78	0.00024	10.5	11.7;
    0.968	14.96	0.00034	10.5	10.6
    ];

% 指标权重
% 从 topsisdaifu.m 中获取的权重
W_test = [0.1560, 0.2662, 0.2634, 0.1947, 0.1197];

% 指标类型
% 第三个指标是成本型（越小越好），其余为效益型（越大越好）
indicator_type_test = [1, 1, -1, 1, 1];


% =================================================================
% 1. 使用 TOPSIS_standard (向量归一化)
% =================================================================
fprintf('\n========== 1. TOPSIS (向量归一化) ==========\n');
[C_std, D_max_std, D_min_std] = TOPSIS_standard(X_test, W_test, indicator_type_test);

% 调用后处理函数进行可视化和导出
postprocess_topsis_results(X_test, C_std, '向量归一化');


% =================================================================
% 2. 使用 TOPSIS_minmax (极差归一化)
% =================================================================
fprintf('\n========== 2. TOPSIS (极差归一化) ==========\n');
[C_mm, D_max_mm, D_min_mm] = TOPSIS_minmax(X_test, W_test, indicator_type_test);

% 调用后处理函数进行可视化和导出
postprocess_topsis_results(X_test, C_mm, '极差归一化');
